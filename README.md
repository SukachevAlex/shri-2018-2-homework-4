# Домашнее задание #4

## Запуск

Установить зависимости `npm install`

Запустить проект `npm run start`

Запустить сервер `npm run server`

Собрать проект `npm run build`

Проверка eslint'ом `npm run lint`

## Ссылка на проект gh-pages

Выложил проект на gh-pages
[Ссылка](https://sukachevalex.github.io/shri-2018-2-homework-4/)

## Ссылка на проект heroku

Ссылка на ветку с heroku
[Ссылка](https://github.com/SukachevAlex/shri-2018-2-homework-4/tree/heroku)

Ссылка на выложенный на heroku сервер
[Ссылка](https://shri-homework-4.herokuapp.com/)

## Основные задачи

* Сервер на express, который поднимается на 8000 порту.
* Обрабатывает роут /status - выдает время, прошедшее с запуска сервера в формате hh:mm:ss.
* Роут /api/events - отдает содержимое файла events.json.
* При передаче параметра type включается фильтрация по типам события.
* При некорректном type - отдается статус 400 "incorrect type".
* Все остальные роуты отдают `<h1>Page not found</h1>`.

## Дополнительные задачи

* Перейти на POST-параметры (не сделал).
* Сделал пагинацию событий.
* Подключить данные к верстке из первого задания.

## Основные моменты
* Использую nodemon для автоматического перезапуска сервера при изменениях.
* Разбил архитектуру приложения: 
  * /data - файлы с данными (events.json);
  * /helpers - вспомогательные функции (data.js - для работы со временем);
  * /routes - роуты приложения.
* Решил в /api/events сделать выдачу файла для get-параметров с помощью потоков, а для post - рекваирить json файл и отправлять с помощью res.json(file).
* Вместо кириллицы выдавало значки, решил добавить ``res.header("Content-Type", "text/cache-manifest");``.
* Думаю, что нерационально использую потоки, т.к. при чтении фильтрую и добавляю chunk'и в буфер, а потом только отдаю на страницу.
* Cделал пагинацию событий. Предусмотрел некорректный ввод параметров. Для паганицаии используется параметры offset и limit. Пример запроса выглядит так `/api/events?offset=2&limit=5`, можно использовать только 1 параметр или вместе с параметром `type`: `/api/events?type=info&offset=3&limit=6`.

* Выложил сервер на heroku (ссылка вверху). Не получилось там создать сервер на 8000 порту, поэтому изменил его на 5000.

* Подключил данные из верстки первых заданий. Теперь данные с помощью fetch берутся с сервера на heroku.

* Выложил конечный результат на gh-pages (ссылка вверху).